<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>OCR录入修正工具</title>
    <script>
        function replaceText() {
            // 获取用户输入的文本
            var inputText = document.getElementById("inputText").value;

            // 内置的正则替换规则
            var replace_rules = [
                { pattern: /(?<!_)[_\—](?!_)/g, replacement: '____' },//#下划线修正，_和—换成____
                { pattern: /(?<=[\u4e00-\u9fa5]_*)[\.\．]/g, replacement: '。' },//标点修正，全角半角句点前有汉字就换成句号
                { pattern: /(?<=[\u4e00-\u9fa5]_*)\?/g, replacement: '？' },//标点修正，英文问号前有汉字就换成中文问号
                { pattern: /(?<=[\u4e00-\u9fa5]_*)\,/g, replacement: '，' },//标点修正，英文逗号前有汉字就换成中文逗号
                { pattern: /(?<=[\u4e00-\u9fa5]_*)\u0028/g, replacement: '（' },//标点修正，英文前括号前有汉字就换成中文括号
                { pattern: /\u0028\uFF09|\uFF08\u0029/g, replacement: '（）' },//左右连续的括号不匹配就换成中文括号
                { pattern: /((?<![\?\？\.\。!\！\u0029\uFF09])\r?\n(?![ABCD]))/g, replacement: '' },//回车修正，删除回车，除非前面有标点或者后面有选项
                { pattern: /(?<=[,.])\s+(?=")/g, replacement: '' },//标点和引号之间去空格
                { pattern: /(?<=[\u4e00-\u9fa5]) +(?=\d|[A-Z])/g, replacement: '' },//识别到汉字+空格+数字或大写字母，删掉空格
                { pattern: /(?<=\d|[A-Z]) +(?=[\u4e00-\u9fa5])/g, replacement: '' },//识别到数字+空格+汉字或大写字母，删掉空格。不匹配小写字母因为这种情况基本都要转公式
                { pattern: /\([ 　]*\)[ 　]*/g, replacement: '(　)' },//英文空格里没有全角空格就加上
                { pattern: /(?<=\n[A-F])[\.\．\。] */g, replacement: '(. )' },//检测回车+选项字母+点，如A.存在，统一换成A. 存在，的形式
                { pattern: /(?<=[米次克吨斤秒分小平方度瓦千分厘毫微人])[、](?=[米秒毫克吨斤度瓦百千人])/g, replacement: '/' },//单位里/总被识别成顿号，这个可以修改回来
                { pattern: /^[\u0028\uFF08]\d+[\u0029\uFF09]/g, replacement: '' },//删除开头有括号的序号
                { pattern: /^\d+[\.\．] */g, replacement: '' },//删除开头数字加点形式的序号
            ];
            // 执行正则替换
            for (var i = 0; i < replace_rules.length; i++) {
                inputText = inputText.replace(replace_rules[i].pattern, replace_rules[i].replacement);
            }
            // 显示替换后的结果
            document.getElementById("resultText").value = inputText;
        }
    </script>
</head>
<body>
    <h1>OCR录入修正工具</h1>
    <textarea id="inputText" rows="10" cols="50" placeholder="在这里输入文本..."></textarea><br><br>
    
    <button onclick="replaceText()">替换</button>
    <h2>替换后的文本：</h2>
    <textarea id="resultText" rows="10" cols="50" readonly></textarea>
    
    <!-- 版权信息 -->
    <footer style="font-size: smaller; margin-top: 20px; text-align: center;">
        作者 &copy; 谢凯 仅供内部测试使用，不保证结果正确性，请勿外传
    </footer>
</body>
</html>