<!DOCTYPE html> 
<html lang="zh"> 
<head> 
    <meta charset="UTF-8"> 
    <title>汉字标注转换器</title> 
    <style> 
        body { 
            font-family: Arial, sans-serif; 
            max-width: 600px; 
            margin: 20px auto; 
            padding: 20px; 
            text-align: center; 
        } 
        textarea { 
            width: 100%; 
            height: 100px; 
            margin-bottom: 10px; 
        } 
        #result { 
            margin-top: 20px; 
            line-height: 1.6; 
            border: 1px solid #ccc; 
            padding: 10px; 
            white-space: pre-wrap; 
            text-align: left; 
            font-family: monospace; 
            user-select: all; 
        } 
        #copyButton { 
            margin-top: 10px; 
        } 
    </style> 
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script> 
</head> 
<body> 
    <h1>汉字标注转换器</h1> 
    <textarea id="inputText" placeholder="在这里输入文本"></textarea> 
    <button onclick="convertText()">转换</button> 
    <div id="result"></div> 
    <button id="copyButton" onclick="copyResult()" style="display:none;">复制 LaTeX 代码</button> 
    <script> 
        function convertText() { 
            const input = document.getElementById('inputText').value; 
            const result = document.getElementById('result'); 
            const copyButton = document.getElementById('copyButton'); 
             
            // 修改正则表达式以支持中文括号 
            const regex = /([^\(（]+)?([^（\(]+)(?:\(([^\)）]+)\)|（([^）]+)）)?/g; 
             
            let convertedText = ''; 
            let match; 
             
            while ((match = regex.exec(input)) !== null) { 
                const [fullMatch, prefix = '', hanzi, engPinyin, cnPinyin] = match; 
                const pinyin = engPinyin || cnPinyin; 
                 
                if (pinyin) { 
                    // 如果有括号内的拼音，使用 MathJax 上标 
                    const parts = pinyin.match(/.{1,1}/g); 
                    const uppercasePinyin = parts.map(p => `\\mathrm{${p}}`).join(''); 
                    convertedText += `${prefix}\\overset{${uppercasePinyin}}{\\mathrm{${hanzi}}}`; 
                } else if (hanzi) { 
                    // 没有括号的汉字直接添加 
                    convertedText += `${prefix || ''}${hanzi}`; 
                } 
            } 
             
            // 显示 LaTeX 代码 
            result.textContent = `${convertedText}`; 
            copyButton.style.display = 'block'; 
 
            // 渲染 MathJax 
            MathJax.Hub.Queue(["Typeset", MathJax.Hub]); 
        } 
 
        function copyResult() { 
            const result = document.getElementById('result'); 
            const tempTextArea = document.createElement('textarea'); 
             
            // 直接使用 result.textContent 进行复制 
            tempTextArea.value = result.textContent.trim(); 
            document.body.appendChild(tempTextArea); 
            tempTextArea.select(); 
            document.execCommand('copy'); 
            document.body.removeChild(tempTextArea); 
            alert('LaTeX 代码已复制到剪贴板'); 
        } 
    </script> 
 
</body> 
</html>
